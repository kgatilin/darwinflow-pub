# Project Architecture

**Generated by go-arch-lint on 2025-10-19**

## Table of Contents
- [Project Structure](#project-structure)
- [Architectural Rules](#architectural-rules)
- [Dependency Graph](#dependency-graph)
- [Public API](#public-api)
- [Statistics](#statistics)

---

## Project Structure

Required directories as defined in `.goarchlint`:

### cmd
**Purpose**: Application entry points

**Allowed dependencies**: internal/app, internal/infra

**Status**: ✓ Exists

---

### internal/app
**Purpose**: Application services, use cases, orchestration

**Allowed dependencies**: internal/domain

**Status**: ✓ Exists

---

### internal/domain
**Purpose**: Core business logic, entities, value objects, domain services

**Allowed dependencies**: None (isolated layer)

**Status**: ✓ Exists

---

### internal/infra
**Purpose**: Infrastructure implementations (DB, external APIs, messaging)

**Allowed dependencies**: internal/domain

**Status**: ✓ Exists

---

---

## Architectural Rules

From `.goarchlint`:

```yaml
structure:
  required_directories:
    cmd: "Application entry points"
    internal/app: "Application services, use cases, orchestration"
    internal/domain: "Core business logic, entities, value objects, domain services"
    internal/infra: "Infrastructure implementations (DB, external APIs, messaging)"
  allow_other_directories: true

rules:
  directories_import:
    internal/infra: [internal/domain]
    cmd: [internal/app, internal/infra]
    internal/app: [internal/domain]
    internal/domain: []
  detect_unused: true
```

**Validation Status**: ✗ 5 violation(s) found (see stderr output)

---

## Dependency Graph

Detailed method-level dependencies between files:

### cmd/dw/analyze.go
**Package**: main

**Local Dependencies**:
- internal/app
  - AnalysisService
  - DefaultDBPath
  - NewAnalysisService
  - NewClaudeCLIExecutorWithConfig
  - NewLogsService
- internal/infra
  - Logger
  - NewConfigLoader
  - NewDebugLogger
  - NewDefaultLogger
  - NewSQLiteEventRepository
  - ValidateModelAlias

**External Dependencies**:
- context
  - Background
  - Context
- flag
  - ContinueOnError
  - ErrHelp
  - NewFlagSet
- fmt
  - Fprintf
  - Printf
  - Println
- os
  - Exit
  - Stderr

---

### cmd/dw/claude.go
**Package**: main

**Local Dependencies**:
- internal/app
  - DefaultDBPath
  - EventMapper
  - HookInputData
  - NewAnalysisService
  - NewClaudeCLIExecutorWithConfig
  - NewLoggerService
  - NewLogsService
  - NewSetupService
- internal/infra
  - NewConfigLoader
  - NewContextDetector
  - NewDefaultLogger
  - NewHookConfigManager
  - NewSQLiteEventRepository
  - NewTranscriptParser
  - NormalizeContent
  - ParseHookInput

**External Dependencies**:
- bytes
  - NewReader
- context
  - Background
- fmt
  - Fprintf
  - Fprintln
  - Println
  - Sscanf
- io
  - NopCloser
  - ReadAll
- os
  - Executable
  - Exit
  - Getenv
  - Stderr
  - Stdin
- os/exec
  - Command

---

### cmd/dw/config.go
**Package**: main

**Local Dependencies**:
- internal/infra
  - DefaultConfigFileName
  - Logger
  - NewConfigLoader
  - NewDebugLogger
  - NewDefaultLogger

**External Dependencies**:
- flag
  - ContinueOnError
  - ErrHelp
  - NewFlagSet
- fmt
  - Fprintf
  - Fprintln
  - Printf
  - Println
- os
  - Exit
  - Stat
  - Stderr

---

### cmd/dw/logs.go
**Package**: main

**Local Dependencies**:
- internal/app
  - DefaultDBPath
  - FormatLogRecord
  - FormatLogsAsCSV
  - FormatLogsAsMarkdown
  - FormatQueryValue
  - LogsService
  - NewLogsService
- internal/infra
  - NewSQLiteEventRepository

**External Dependencies**:
- context
  - Background
  - Context
- flag
  - ContinueOnError
  - NewFlagSet
- fmt
  - Fprintf
  - Print
  - Printf
  - Println
- os
  - Exit
  - IsNotExist
  - Stat
  - Stderr
  - Stdout

---

### cmd/dw/logs_test.go
**Package**: main

**Local Dependencies**:
- internal/app
  - NewLogsService
- internal/infra
  - NewSQLiteEventRepository

**External Dependencies**:
- context
  - Background
- path/filepath
  - Join
- testing
  - T

---

### cmd/dw/main.go
**Package**: main

**Local Dependencies**: None

**External Dependencies**:
- fmt
  - Fprintf
  - Println
- os
  - Args
  - Exit
  - Stderr

---

### cmd/dw/refresh.go
**Package**: main

**Local Dependencies**:
- internal/app
  - DefaultDBPath
- internal/infra
  - DefaultConfigFileName
  - NewConfigLoader
  - NewDefaultLogger
  - NewHookConfigManager
  - NewSQLiteEventRepository

**External Dependencies**:
- context
  - Background
- fmt
  - Fprintf
  - Println
- os
  - Exit
  - Stderr

---

### cmd/dw/ui.go
**Package**: main

**Local Dependencies**:
- internal/app
  - DefaultDBPath
  - NewAnalysisService
  - NewClaudeCLIExecutorWithConfig
  - NewLogsService
  - NewPluginRegistry
- internal/app/plugins/claude_code
  - NewClaudeCodePlugin
- internal/app/tui
  - Run
- internal/infra
  - Logger
  - NewConfigLoader
  - NewDebugLogger
  - NewDefaultLogger
  - NewSQLiteEventRepository

**External Dependencies**:
- context
  - Background
- flag
  - ContinueOnError
  - ErrHelp
  - NewFlagSet
- fmt
  - Fprintf
- os
  - Exit
  - Stderr

---

### internal/app/analysis.go
**Package**: app

**Local Dependencies**:
- internal/domain
  - AnalysisRepository
  - Config
  - DefaultConfig
  - DefaultToolAnalysisPrompt
  - EventRepository
  - NewSessionAnalysisWithType
  - SessionAnalysis

**External Dependencies**:
- bytes
  - Buffer
- context
  - Context
- fmt
  - Errorf
  - Sprintf
- io
  - MultiWriter
- os
  - MkdirAll
  - Stderr
  - WriteFile
- os/exec
  - CommandContext
- path/filepath
  - Ext
  - Join
- strings
  - Join
  - TrimSpace
- sync
  - WaitGroup
- text/template
  - New
- time
  - Now
  - RFC3339

---

### internal/app/analysis_prompt.go
**Package**: app

**Local Dependencies**: None

**External Dependencies**: None

---

### internal/app/analysis_test.go
**Package**: app

**Local Dependencies**:
- internal/domain
  - SessionAnalysis

**External Dependencies**:
- context
  - Context
- testing
  - T

---

### internal/app/logger.go
**Package**: app

**Local Dependencies**:
- internal/domain
  - ChatMessageAssistant
  - ChatMessageUser
  - ChatPayload
  - ChatStarted
  - ContextChanged
  - Error
  - EventRepository
  - EventType
  - FileRead
  - FileWritten
  - NewEvent
  - ToolInvoked
  - ToolPayload
  - ToolResult

**External Dependencies**:
- context
  - Context
- encoding/json
  - Marshal
- fmt
  - Errorf
- strings
  - ReplaceAll
  - ToLower

---

### internal/app/logs.go
**Package**: app

**Local Dependencies**:
- internal/domain
  - Event
  - EventQuery
  - EventRepository
  - QueryResult
  - RawQueryExecutor

**External Dependencies**:
- context
  - Context
- encoding/csv
  - NewWriter
- encoding/json
  - Marshal
  - MarshalIndent
  - RawMessage
  - Unmarshal
- fmt
  - Errorf
  - Fprintf
  - Fprintln
  - Sprintf
- io
  - Writer
- sort
  - Slice
- time
  - Millisecond
  - RFC3339
  - Time
  - UnixMilli

---

### internal/app/plugin_registry.go
**Package**: app

**Local Dependencies**:
- internal/domain
  - EntityQuery
  - EntityTypeInfo
  - IExtensible
  - Plugin

**External Dependencies**:
- context
  - Context
- fmt
  - Errorf
- sync
  - RWMutex

---

### internal/app/plugin_registry_test.go
**Package**: app_test

**Local Dependencies**:
- internal/app
  - NewPluginRegistry
  - NoOpLogger
- internal/domain
  - EntityQuery
  - EntityTypeInfo
  - ErrNotFound
  - IExtensible
  - PluginInfo

**External Dependencies**:
- context
  - Background
  - Context
- testing
  - T

---

### internal/app/plugins/claude_code/plugin.go
**Package**: claude_code

**Local Dependencies**:
- internal/app
  - AnalysisService
  - Logger
  - LogsService
- internal/domain
  - EntityQuery
  - EntityTypeInfo
  - IExtensible
  - PluginInfo
  - SessionAnalysis

**External Dependencies**:
- context
  - Context
- fmt
  - Errorf

---

### internal/app/plugins/claude_code/session_entity.go
**Package**: claude_code

**Local Dependencies**:
- internal/domain
  - ActivityRecord
  - EntityContext
  - SessionAnalysis

**External Dependencies**:
- time
  - Time

---

### internal/app/setup.go
**Package**: app

**Local Dependencies**:
- internal/domain
  - EventRepository

**External Dependencies**:
- context
  - Context
- fmt
  - Errorf
- os
  - MkdirAll
- path/filepath
  - Dir

---

### internal/app/tui/analysisviewer.go
**Package**: tui

**Local Dependencies**:
- internal/domain
  - SessionAnalysis

**External Dependencies**:
- fmt
  - Sprintf
- strings
  - Builder
  - Repeat
- github.com/charmbracelet/bubbles/viewport
  - Model
  - New
- github.com/charmbracelet/glamour
  - NewTermRenderer
  - WithStandardStyle
  - WithWordWrap
- github.com/charmbracelet/bubbletea
  - Batch
  - Cmd
  - KeyMsg
  - Model
  - Msg
  - WindowSizeMsg
- github.com/charmbracelet/lipgloss
  - Color
  - Height
  - Left
  - NewStyle
  - NormalBorder
  - Width

---

### internal/app/tui/app.go
**Package**: tui

**Local Dependencies**:
- internal/app
  - AnalysisService
  - LogsService
  - PluginRegistry
- internal/domain
  - Config
  - EntityQuery

**External Dependencies**:
- context
  - Context
- fmt
  - Errorf
  - Sprintf
- time
  - Time
- github.com/charmbracelet/bubbles/spinner
  - Dot
  - Model
  - New
  - TickMsg
- github.com/charmbracelet/bubbletea
  - Batch
  - Cmd
  - KeyMsg
  - Model
  - Msg
  - NewProgram
  - Quit
  - WindowSizeMsg
  - WithAltScreen
- github.com/charmbracelet/lipgloss
  - Color
  - NewStyle
  - RoundedBorder

---

### internal/app/tui/logviewer.go
**Package**: tui

**Local Dependencies**:
- internal/app
  - FormatLogsAsMarkdown
  - LogRecord

**External Dependencies**:
- bytes
  - Buffer
- fmt
  - Sprintf
- strings
  - Repeat
- github.com/charmbracelet/bubbles/viewport
  - Model
  - New
- github.com/charmbracelet/glamour
  - NewTermRenderer
  - WithStandardStyle
  - WithWordWrap
- github.com/charmbracelet/bubbletea
  - Batch
  - Cmd
  - KeyMsg
  - Model
  - Msg
  - WindowSizeMsg
- github.com/charmbracelet/lipgloss
  - Color
  - Height
  - NewStyle
  - Width

---

### internal/app/tui/sessiondetail.go
**Package**: tui

**Local Dependencies**: None

**External Dependencies**:
- fmt
  - Sprintf
- strings
  - Builder
  - Join
  - Repeat
- github.com/charmbracelet/bubbles/viewport
  - Model
  - New
- github.com/charmbracelet/bubbletea
  - Batch
  - Cmd
  - KeyMsg
  - Model
  - Msg
  - WindowSizeMsg
- github.com/charmbracelet/lipgloss
  - Color
  - Height
  - Left
  - NewStyle
  - NormalBorder
  - RoundedBorder
  - Width

---

### internal/app/tui/sessiondetail_test.go
**Package**: tui

**Local Dependencies**: None

**External Dependencies**:
- testing
  - T

---

### internal/app/tui/sessionlist.go
**Package**: tui

**Local Dependencies**: None

**External Dependencies**:
- fmt
  - Sprintf
- strings
  - Join
- github.com/charmbracelet/bubbles/list
  - DefaultStyles
  - Item
  - Model
  - New
  - NewDefaultDelegate
- github.com/charmbracelet/bubbletea
  - Cmd
  - KeyMsg
  - Model
  - Msg
  - Quit
  - WindowSizeMsg
- github.com/charmbracelet/lipgloss
  - Color
  - NewStyle

---

### internal/app/tui/types.go
**Package**: tui

**Local Dependencies**:
- internal/domain
  - SessionAnalysis

**External Dependencies**:
- time
  - Time

---

### internal/domain/analysis.go
**Package**: domain

**Local Dependencies**: None

**External Dependencies**:
- time
  - Now
  - Time
- github.com/google/uuid
  - New

---

### internal/domain/capability.go
**Package**: domain

**Local Dependencies**: None

**External Dependencies**:
- time
  - Time

---

### internal/domain/config.go
**Package**: domain

**Local Dependencies**: None

**External Dependencies**: None

---

### internal/domain/event.go
**Package**: domain

**Local Dependencies**: None

**External Dependencies**:
- encoding/json
  - Marshal
- time
  - Now
  - Time
- github.com/google/uuid
  - New

---

### internal/domain/plugin.go
**Package**: domain

**Local Dependencies**: None

**External Dependencies**:
- context
  - Context
- errors
  - New

---

### internal/domain/repository.go
**Package**: domain

**Local Dependencies**: None

**External Dependencies**:
- context
  - Context
- time
  - Time

---

### internal/domain/trigger.go
**Package**: domain

**Local Dependencies**: None

**External Dependencies**: None

---

### internal/infra/analysis_repository_test.go
**Package**: infra

**Local Dependencies**:
- internal/domain
  - ChatPayload
  - ChatStarted
  - Event
  - NewEvent
  - NewSessionAnalysis
  - SessionAnalysis

**External Dependencies**:
- context
  - Background
- path/filepath
  - Join
- testing
  - T
- time
  - Millisecond
  - Sleep

---

### internal/infra/config.go
**Package**: infra

**Local Dependencies**:
- internal/domain
  - Config
  - DefaultConfig
  - ValidateModel

**External Dependencies**:
- fmt
  - Errorf
- os
  - Getwd
  - IsNotExist
  - ReadFile
  - Stat
  - WriteFile
- path/filepath
  - Join
- gopkg.in/yaml.v3

---

### internal/infra/context.go
**Package**: infra

**Local Dependencies**: None

**External Dependencies**:
- encoding/json
  - Marshal
  - Unmarshal
- fmt
  - Sprintf
- os
  - Getenv
  - Getwd
  - Stat
- path/filepath
  - Base
  - Dir
  - Join
- strings
  - Join
  - TrimSpace

---

### internal/infra/hook_config.go
**Package**: infra

**Local Dependencies**: None

**External Dependencies**:
- encoding/json
  - Marshal
  - MarshalIndent
  - Unmarshal
- fmt
  - Errorf
- os
  - IsNotExist
  - MkdirAll
  - ReadFile
  - Stat
  - WriteFile
- path/filepath
  - Dir

---

### internal/infra/hook_input.go
**Package**: infra

**Local Dependencies**: None

**External Dependencies**:
- encoding/json
  - Unmarshal
- io
  - ReadAll
  - Reader

---

### internal/infra/logger.go
**Package**: infra

**Local Dependencies**: None

**External Dependencies**:
- fmt
  - Fprintf
  - Sprintf
- io
  - Writer
- os
  - Stderr
- sync
  - Mutex
- time
  - Now

---

### internal/infra/sqlite_repository.go
**Package**: infra

**Local Dependencies**:
- internal/domain
  - Event
  - EventQuery
  - EventType
  - QueryResult
  - SessionAnalysis

**External Dependencies**:
- context
  - Context
- database/sql
  - DB
  - ErrNoRows
  - NullString
  - Open
- encoding/json
  - RawMessage
  - Unmarshal
- fmt
  - Errorf
  - Sprintf
- strings
  - Join
- time
  - Millisecond
  - Time
  - Unix
- github.com/mattn/go-sqlite3

---

### internal/infra/sqlite_repository_test.go
**Package**: infra

**Local Dependencies**: None

**External Dependencies**:
- context
  - Background
- database/sql
  - Open
- path/filepath
  - Join
- testing
  - T
- time
  - Date
  - Now
  - UTC
  - UnixMilli
- github.com/mattn/go-sqlite3

---

### internal/infra/transcript.go
**Package**: infra

**Local Dependencies**: None

**External Dependencies**:
- bufio
  - NewScanner
- encoding/json
  - Marshal
  - Unmarshal
- fmt
  - Errorf
- os
  - Open
- strings
  - TrimSpace

---

## Public API

Exported interfaces and types available for consumption:

### domain

#### Types

**SessionAnalysis** `SessionAnalysis`
- Properties:
  - ID string
  - SessionID string
  - AnalyzedAt time.Time
  - AnalysisResult string
  - ModelUsed string
  - PromptUsed string
  - PatternsSummary string
  - AnalysisType string
  - PromptName string

**NewSessionAnalysis** `NewSessionAnalysis(string) *SessionAnalysis`

**NewSessionAnalysisWithType** `NewSessionAnalysisWithType(string) *SessionAnalysis`

**ToolSuggestion** `ToolSuggestion`
- Properties:
  - Name string
  - Description string
  - Rationale string
  - Examples []string

#### Types

**IExtensible** `IExtensible`

**IHasContext** `IHasContext`

**EntityContext** `EntityContext`
- Properties:
  - RelatedEntities map[string][]string
  - LinkedFiles []string
  - RecentActivity []ActivityRecord
  - Metadata map[string]interface{}

**ActivityRecord** `ActivityRecord`
- Properties:
  - Timestamp time.Time
  - Action string
  - Details map[string]interface{}

**ITrackable** `ITrackable`

**ISchedulable** `ISchedulable`

**IRelatable** `IRelatable`

#### Types

**Config** `Config`
- Properties:
  - Analysis AnalysisConfig
  - UI UIConfig
  - Prompts map[string]string

**AnalysisConfig** `AnalysisConfig`
- Properties:
  - TokenLimit int
  - Model string
  - ParallelLimit int
  - EnabledPrompts []string
  - AutoSummaryEnabled bool
  - AutoSummaryPrompt string
  - ClaudeOptions ClaudeOptions

**ClaudeOptions** `ClaudeOptions`
- Properties:
  - AllowedTools []string
  - SystemPromptMode string

**UIConfig** `UIConfig`
- Properties:
  - DefaultOutputDir string
  - FilenameTemplate string
  - AutoRefreshInterval string

**AllowedModels** `AllowedModels`

**ValidateModel** `ValidateModel(string) bool`

**DefaultConfig** `DefaultConfig() *Config`

**DefaultSessionSummaryPrompt** `DefaultSessionSummaryPrompt`

**DefaultToolAnalysisPrompt** `DefaultToolAnalysisPrompt`

**DefaultAnalysisPrompt** `DefaultAnalysisPrompt`

#### Types

**EventType** `EventType`

**ChatStarted** `ChatStarted`

**ChatMessageUser** `ChatMessageUser`

**ChatMessageAssistant** `ChatMessageAssistant`

**ToolInvoked** `ToolInvoked`

**ToolResult** `ToolResult`

**FileRead** `FileRead`

**FileWritten** `FileWritten`

**ContextChanged** `ContextChanged`

**Error** `Error`

**Event** `Event`
- Properties:
  - ID string
  - Timestamp time.Time
  - Type EventType
  - SessionID string
  - Payload interface{}
  - Content string

**NewEvent** `NewEvent(EventType, string, interface{}, string) *Event`

**MarshalPayload** `(*Event) MarshalPayload() ([]byte, error)`

**ChatPayload** `ChatPayload`
- Properties:
  - Message string
  - Context string

**ToolPayload** `ToolPayload`
- Properties:
  - Tool string
  - Parameters interface{}
  - Result interface{}
  - DurationMs int64
  - Context string

**FilePayload** `FilePayload`
- Properties:
  - FilePath string
  - Changes string
  - DurationMs int64
  - Context string

**ContextPayload** `ContextPayload`
- Properties:
  - Context string
  - Description string

**ErrorPayload** `ErrorPayload`
- Properties:
  - Error string
  - StackTrace string
  - Context string

#### Types

**ErrNotFound** `ErrNotFound`

**Plugin** `Plugin`

**PluginInfo** `PluginInfo`
- Properties:
  - Name string
  - Version string
  - Description string
  - IsCore bool

**EntityTypeInfo** `EntityTypeInfo`
- Properties:
  - Type string
  - DisplayName string
  - DisplayNamePlural string
  - Capabilities []string
  - Icon string

**EntityQuery** `EntityQuery`
- Properties:
  - EntityType string
  - Capabilities []string
  - Filters map[string]interface{}
  - Limit int
  - Offset int
  - OrderBy string
  - OrderDesc bool

#### Types

**EventRepository** `EventRepository`

**EventQuery** `EventQuery`
- Properties:
  - StartTime *time.Time
  - EndTime *time.Time
  - EventTypes []EventType
  - SessionID string
  - Context string
  - SearchText string
  - OrderByTime bool
  - Limit int
  - Offset int

**QueryResult** `QueryResult`
- Properties:
  - Columns []string
  - Rows [][]interface{}

**RawQueryExecutor** `RawQueryExecutor`

**AnalysisRepository** `AnalysisRepository`

#### Types

**TriggerType** `TriggerType`

**TriggerPreToolUse** `TriggerPreToolUse`

**TriggerPostToolUse** `TriggerPostToolUse`

**TriggerNotification** `TriggerNotification`

**TriggerUserPromptSubmit** `TriggerUserPromptSubmit`

**TriggerStop** `TriggerStop`

**TriggerSubagentStop** `TriggerSubagentStop`

**TriggerPreCompact** `TriggerPreCompact`

**TriggerSessionStart** `TriggerSessionStart`

**TriggerSessionEnd** `TriggerSessionEnd`

---

### infra

#### Types

**TestSQLiteEventRepository_SaveAnalysis** `TestSQLiteEventRepository_SaveAnalysis(*testing.T)`

**TestSQLiteEventRepository_GetUnanalyzedSessionIDs** `TestSQLiteEventRepository_GetUnanalyzedSessionIDs(*testing.T)`

**TestSQLiteEventRepository_GetAllAnalyses** `TestSQLiteEventRepository_GetAllAnalyses(*testing.T)`

**TestSQLiteEventRepository_GetAnalysisBySessionID_NotFound** `TestSQLiteEventRepository_GetAnalysisBySessionID_NotFound(*testing.T)`

#### Types

**DefaultConfigFileName** `DefaultConfigFileName`

**ConfigLoader** `ConfigLoader`

**NewConfigLoader** `NewConfigLoader(*Logger) *ConfigLoader`

**LoadConfig** `(*ConfigLoader) LoadConfig(string) (*domain.Config, error)`

**ValidateModelAlias** `ValidateModelAlias(string) bool`

**SaveConfig** `(*ConfigLoader) SaveConfig(*domain.Config, string) error`

**GetPrompt** `(*ConfigLoader) GetPrompt(*domain.Config, string) (string, bool)`

**InitializeDefaultConfig** `(*ConfigLoader) InitializeDefaultConfig(string) error`

#### Types

**ContextDetector** `ContextDetector`

**NewContextDetector** `NewContextDetector() *ContextDetector`

**DetectContext** `(*ContextDetector) DetectContext() string`

**NormalizeContent** `NormalizeContent(string) string`

#### Types

**HookConfig** `HookConfig`
- Properties:
  - Hooks map[string][]HookMatcher

**HookMatcher** `HookMatcher`
- Properties:
  - Matcher string
  - Hooks []HookAction

**HookAction** `HookAction`
- Properties:
  - Type string
  - Command string
  - Timeout int

**DefaultDarwinFlowConfig** `DefaultDarwinFlowConfig() HookConfig`

**MergeHookConfigs** `MergeHookConfigs(HookConfig) HookConfig`

**HookConfigManager** `HookConfigManager`

**NewHookConfigManager** `NewHookConfigManager() (*HookConfigManager, error)`

**ClaudeSettings** `ClaudeSettings`
- Properties:
  - Hooks map[string][]HookMatcher
  - Other map[string]interface{}

**ReadSettings** `(*HookConfigManager) ReadSettings() (*ClaudeSettings, error)`

**WriteSettings** `(*HookConfigManager) WriteSettings(*ClaudeSettings) error`

**InstallDarwinFlowHooks** `(*HookConfigManager) InstallDarwinFlowHooks() error`

**GetSettingsPath** `(*HookConfigManager) GetSettingsPath() string`

#### Types

**HookInput** `HookInput`
- Properties:
  - SessionID string
  - TranscriptPath string
  - CWD string
  - PermissionMode string
  - HookEventName string
  - ToolName string
  - ToolInput map[string]interface{}
  - ToolOutput interface{}
  - Error interface{}
  - UserMessage string
  - Prompt string

**ParseHookInput** `ParseHookInput(io.Reader) (*HookInput, error)`

#### Types

**LogLevel** `LogLevel`

**LogLevelDebug** `LogLevelDebug`

**LogLevelInfo** `LogLevelInfo`

**LogLevelWarn** `LogLevelWarn`

**LogLevelError** `LogLevelError`

**String** `(LogLevel) String() string`

**Logger** `Logger`

**NewLogger** `NewLogger(io.Writer, LogLevel) *Logger`

**NewDefaultLogger** `NewDefaultLogger() *Logger`

**NewDebugLogger** `NewDebugLogger() *Logger`

**SetLevel** `(*Logger) SetLevel(LogLevel)`

**Debug** `(*Logger) Debug(string, ...interface{})`

**Info** `(*Logger) Info(string, ...interface{})`

**Warn** `(*Logger) Warn(string, ...interface{})`

**Error** `(*Logger) Error(string, ...interface{})`

#### Types

**SQLiteEventRepository** `SQLiteEventRepository`

**NewSQLiteEventRepository** `NewSQLiteEventRepository(string) (*SQLiteEventRepository, error)`

**Initialize** `(*SQLiteEventRepository) Initialize(context.Context) error`

**Save** `(*SQLiteEventRepository) Save(context.Context, *domain.Event) error`

**FindByQuery** `(*SQLiteEventRepository) FindByQuery(context.Context, domain.EventQuery) ([]*domain.Event, error)`

**Close** `(*SQLiteEventRepository) Close() error`

**ExecuteRawQuery** `(*SQLiteEventRepository) ExecuteRawQuery(context.Context, string) (*domain.QueryResult, error)`

**SaveAnalysis** `(*SQLiteEventRepository) SaveAnalysis(context.Context, *domain.SessionAnalysis) error`

**GetAnalysisBySessionID** `(*SQLiteEventRepository) GetAnalysisBySessionID(context.Context, string) (*domain.SessionAnalysis, error)`

**GetAnalysesBySessionID** `(*SQLiteEventRepository) GetAnalysesBySessionID(context.Context, string) ([]*domain.SessionAnalysis, error)`

**GetUnanalyzedSessionIDs** `(*SQLiteEventRepository) GetUnanalyzedSessionIDs(context.Context) ([]string, error)`

**GetAllAnalyses** `(*SQLiteEventRepository) GetAllAnalyses(context.Context, int) ([]*domain.SessionAnalysis, error)`

**GetAllSessionIDs** `(*SQLiteEventRepository) GetAllSessionIDs(context.Context, int) ([]string, error)`

#### Types

**TestSQLiteEventRepository_EmptyDatabase** `TestSQLiteEventRepository_EmptyDatabase(*testing.T)`

**TestSQLiteEventRepository_WithData** `TestSQLiteEventRepository_WithData(*testing.T)`

**TestSQLiteEventRepository_ExecuteRawQuery_SelectQuery** `TestSQLiteEventRepository_ExecuteRawQuery_SelectQuery(*testing.T)`

**TestSQLiteEventRepository_ExecuteRawQuery_InvalidQuery** `TestSQLiteEventRepository_ExecuteRawQuery_InvalidQuery(*testing.T)`

**TestSQLiteEventRepository_TimestampFormatting** `TestSQLiteEventRepository_TimestampFormatting(*testing.T)`

**TestSQLiteEventRepository_DatabaseSchema** `TestSQLiteEventRepository_DatabaseSchema(*testing.T)`

#### Types

**TranscriptEntry** `TranscriptEntry`
- Properties:
  - Role string
  - Content string
  - Type string
  - Name string
  - Parameters map[string]interface{}
  - Input map[string]interface{}

**TranscriptParser** `TranscriptParser`

**NewTranscriptParser** `NewTranscriptParser() *TranscriptParser`

**Parse** `(*TranscriptParser) Parse(string) ([]TranscriptEntry, error)`

**ExtractLastToolUse** `(*TranscriptParser) ExtractLastToolUse(string, int) (string, string, error)`

**ExtractLastUserMessage** `(*TranscriptParser) ExtractLastUserMessage(string) (string, error)`

**ExtractLastAssistantMessage** `(*TranscriptParser) ExtractLastAssistantMessage(string) (string, error)`

---

### main

#### Types

**TestRepeatString** `TestRepeatString(*testing.T)`

**TestParseLogsFlags** `TestParseLogsFlags(*testing.T)`

**TestListLogs_EmptyDB** `TestListLogs_EmptyDB(*testing.T)`

**TestExecuteRawQuery_Success** `TestExecuteRawQuery_Success(*testing.T)`

**TestExecuteRawQuery_InvalidSQL** `TestExecuteRawQuery_InvalidSQL(*testing.T)`

---

### app

#### Types

**NoOpLogger** `NoOpLogger`

**Debug** `(*NoOpLogger) Debug(string, ...interface{})`

**Info** `(*NoOpLogger) Info(string, ...interface{})`

**Warn** `(*NoOpLogger) Warn(string, ...interface{})`

**Error** `(*NoOpLogger) Error(string, ...interface{})`

**LLMExecutor** `LLMExecutor`

**Logger** `Logger`

**AnalysisService** `AnalysisService`

**NewAnalysisService** `NewAnalysisService(domain.EventRepository, domain.AnalysisRepository, *LogsService, LLMExecutor, Logger, *domain.Config) *AnalysisService`

**AnalyzeSession** `(*AnalysisService) AnalyzeSession(context.Context, string) (*domain.SessionAnalysis, error)`

**AnalyzeSessionWithPrompt** `(*AnalysisService) AnalyzeSessionWithPrompt(context.Context, string) (*domain.SessionAnalysis, error)`

**AnalyzeMultipleSessions** `(*AnalysisService) AnalyzeMultipleSessions(context.Context, []string, string) (map[string]*domain.SessionAnalysis, []error)`

**AnalysisResult** `AnalysisResult`
- Properties:
  - SessionID string
  - PromptName string
  - Analysis *domain.SessionAnalysis
  - Error error

**AnalyzeMultipleSessionsParallel** `(*AnalysisService) AnalyzeMultipleSessionsParallel(context.Context, []string, string) (map[string]*domain.SessionAnalysis, []error)`

**AnalyzeSessionWithMultiplePrompts** `(*AnalysisService) AnalyzeSessionWithMultiplePrompts(context.Context, string, []string) (map[string]*domain.SessionAnalysis, []error)`

**EstimateTokenCount** `(*AnalysisService) EstimateTokenCount(context.Context, string) (int, error)`

**SelectSessionsWithinTokenLimit** `(*AnalysisService) SelectSessionsWithinTokenLimit(context.Context, []string, int) ([]string, int, error)`

**GetLastSession** `(*AnalysisService) GetLastSession(context.Context) (string, error)`

**GetUnanalyzedSessions** `(*AnalysisService) GetUnanalyzedSessions(context.Context) ([]string, error)`

**GetAnalysis** `(*AnalysisService) GetAnalysis(context.Context, string) (*domain.SessionAnalysis, error)`

**GetAnalysesBySessionID** `(*AnalysisService) GetAnalysesBySessionID(context.Context, string) ([]*domain.SessionAnalysis, error)`

**GetAllSessionIDs** `(*AnalysisService) GetAllSessionIDs(context.Context, int) ([]string, error)`

**FilenameTmplData** `FilenameTmplData`
- Properties:
  - SessionID string
  - PromptName string
  - Date string
  - Time string

**SaveToMarkdown** `(*AnalysisService) SaveToMarkdown(context.Context, *domain.SessionAnalysis, string) (string, error)`

**ClaudeCLIExecutor** `ClaudeCLIExecutor`

**NewClaudeCLIExecutor** `NewClaudeCLIExecutor(Logger) *ClaudeCLIExecutor`

**NewClaudeCLIExecutorWithConfig** `NewClaudeCLIExecutorWithConfig(Logger, *domain.Config) *ClaudeCLIExecutor`

**Execute** `(*ClaudeCLIExecutor) Execute(context.Context, string) (string, error)`

**ExecuteWithOptions** `(*ClaudeCLIExecutor) ExecuteWithOptions(context.Context, string, map[string]interface{}) (string, error)`

#### Types

**DefaultAnalysisPrompt** `DefaultAnalysisPrompt`

**GetAnalysisPrompt** `GetAnalysisPrompt(string) string`

#### Types

**MockLLMExecutor** `MockLLMExecutor`
- Properties:
  - Response string
  - Error error

**Execute** `(*MockLLMExecutor) Execute(context.Context, string) (string, error)`

**MockAnalysisRepository** `MockAnalysisRepository`
- Properties:
  - SavedAnalyses []*domain.SessionAnalysis
  - UnanalyzedIDs []string
  - AnalysisByID map[string]*domain.SessionAnalysis
  - SaveError error
  - GetError error
  - UnanalyzedError error

**NewMockAnalysisRepository** `NewMockAnalysisRepository() *MockAnalysisRepository`

**SaveAnalysis** `(*MockAnalysisRepository) SaveAnalysis(context.Context, *domain.SessionAnalysis) error`

**GetAnalysisBySessionID** `(*MockAnalysisRepository) GetAnalysisBySessionID(context.Context, string) (*domain.SessionAnalysis, error)`

**GetUnanalyzedSessionIDs** `(*MockAnalysisRepository) GetUnanalyzedSessionIDs(context.Context) ([]string, error)`

**GetAllAnalyses** `(*MockAnalysisRepository) GetAllAnalyses(context.Context, int) ([]*domain.SessionAnalysis, error)`

**GetAllSessionIDs** `(*MockAnalysisRepository) GetAllSessionIDs(context.Context, int) ([]string, error)`

**TestGetAnalysisPrompt** `TestGetAnalysisPrompt(*testing.T)`

**TestClaudeCLIExecutor_Integration** `TestClaudeCLIExecutor_Integration(*testing.T)`

#### Types

**EventMapper** `EventMapper`

**MapEventType** `(*EventMapper) MapEventType(string) domain.EventType`

**TranscriptParser** `TranscriptParser`

**ContextDetector** `ContextDetector`

**ContentNormalizer** `ContentNormalizer`

**HookInputData** `HookInputData`
- Properties:
  - SessionID string
  - TranscriptPath string
  - CWD string
  - PermissionMode string
  - HookEventName string
  - ToolName string
  - ToolInput map[string]interface{}
  - ToolOutput interface{}
  - Error interface{}
  - UserMessage string
  - Prompt string

**LoggerService** `LoggerService`

**NewLoggerService** `NewLoggerService(domain.EventRepository, TranscriptParser, ContextDetector, ContentNormalizer) *LoggerService`

**LogEvent** `(*LoggerService) LogEvent(context.Context, domain.EventType, interface{}) error`

**LogFromHookInput** `(*LoggerService) LogFromHookInput(context.Context, HookInputData, domain.EventType, int) error`

**Close** `(*LoggerService) Close() error`

#### Types

**LogRecord** `LogRecord`
- Properties:
  - ID string
  - Timestamp time.Time
  - EventType string
  - SessionID string
  - Payload json.RawMessage
  - Content string

**LogsService** `LogsService`

**NewLogsService** `NewLogsService(domain.EventRepository, domain.RawQueryExecutor) *LogsService`

**ListRecentLogs** `(*LogsService) ListRecentLogs(context.Context, int, int, string, bool) ([]*LogRecord, error)`

**ExecuteRawQuery** `(*LogsService) ExecuteRawQuery(context.Context, string) (*domain.QueryResult, error)`

**FormatLogRecord** `FormatLogRecord(int, *LogRecord) string`

**FormatQueryValue** `FormatQueryValue(interface{}) string`

**FormatLogsAsCSV** `FormatLogsAsCSV(io.Writer, []*LogRecord) error`

**FormatLogsAsMarkdown** `FormatLogsAsMarkdown(io.Writer, []*LogRecord) error`

**SessionGroup** `SessionGroup`
- Properties:
  - SessionID string
  - Records []*LogRecord
  - StartTime time.Time
  - EndTime time.Time

#### Types

**PluginRegistry** `PluginRegistry`

**NewPluginRegistry** `NewPluginRegistry(Logger) *PluginRegistry`

**RegisterPlugin** `(*PluginRegistry) RegisterPlugin(domain.Plugin) error`

**GetPlugin** `(*PluginRegistry) GetPlugin(string) (domain.Plugin, error)`

**GetPluginForEntityType** `(*PluginRegistry) GetPluginForEntityType(string) (domain.Plugin, error)`

**GetAllPlugins** `(*PluginRegistry) GetAllPlugins() []domain.Plugin`

**GetAllEntityTypes** `(*PluginRegistry) GetAllEntityTypes() []domain.EntityTypeInfo`

**Query** `(*PluginRegistry) Query(context.Context, domain.EntityQuery) ([]domain.IExtensible, error)`

**GetEntity** `(*PluginRegistry) GetEntity(context.Context, string) (domain.IExtensible, error)`

**UpdateEntity** `(*PluginRegistry) UpdateEntity(context.Context, string, map[string]interface{}) (domain.IExtensible, error)`

#### Types

**DefaultDBPath** `DefaultDBPath`

**HookConfigManager** `HookConfigManager`

**SetupService** `SetupService`

**NewSetupService** `NewSetupService(domain.EventRepository, HookConfigManager) *SetupService`

**Initialize** `(*SetupService) Initialize(context.Context, string) error`

**GetSettingsPath** `(*SetupService) GetSettingsPath() string`

---

### app_test

#### Types

**MockPlugin** `MockPlugin`

**NewMockPlugin** `NewMockPlugin(string, []domain.EntityTypeInfo) *MockPlugin`

**GetInfo** `(*MockPlugin) GetInfo() domain.PluginInfo`

**GetEntityTypes** `(*MockPlugin) GetEntityTypes() []domain.EntityTypeInfo`

**Query** `(*MockPlugin) Query(context.Context, domain.EntityQuery) ([]domain.IExtensible, error)`

**GetEntity** `(*MockPlugin) GetEntity(context.Context, string) (domain.IExtensible, error)`

**UpdateEntity** `(*MockPlugin) UpdateEntity(context.Context, string, map[string]interface{}) (domain.IExtensible, error)`

**MockEntity** `MockEntity`

**NewMockEntity** `NewMockEntity(string, []string) *MockEntity`

**GetID** `(*MockEntity) GetID() string`

**GetType** `(*MockEntity) GetType() string`

**GetCapabilities** `(*MockEntity) GetCapabilities() []string`

**GetField** `(*MockEntity) GetField(string) interface{}`

**GetAllFields** `(*MockEntity) GetAllFields() map[string]interface{}`

**TestPluginRegistry_RegisterPlugin** `TestPluginRegistry_RegisterPlugin(*testing.T)`

**TestPluginRegistry_RegisterPlugin_Duplicate** `TestPluginRegistry_RegisterPlugin_Duplicate(*testing.T)`

**TestPluginRegistry_RegisterPlugin_EntityTypeConflict** `TestPluginRegistry_RegisterPlugin_EntityTypeConflict(*testing.T)`

**TestPluginRegistry_GetPluginForEntityType** `TestPluginRegistry_GetPluginForEntityType(*testing.T)`

**TestPluginRegistry_Query** `TestPluginRegistry_Query(*testing.T)`

**TestPluginRegistry_GetAllEntityTypes** `TestPluginRegistry_GetAllEntityTypes(*testing.T)`

---

### claude_code

#### Types

**ClaudeCodePlugin** `ClaudeCodePlugin`

**NewClaudeCodePlugin** `NewClaudeCodePlugin(*app.AnalysisService, *app.LogsService, app.Logger) *ClaudeCodePlugin`

**GetInfo** `(*ClaudeCodePlugin) GetInfo() domain.PluginInfo`

**GetEntityTypes** `(*ClaudeCodePlugin) GetEntityTypes() []domain.EntityTypeInfo`

**Query** `(*ClaudeCodePlugin) Query(context.Context, domain.EntityQuery) ([]domain.IExtensible, error)`

**GetEntity** `(*ClaudeCodePlugin) GetEntity(context.Context, string) (domain.IExtensible, error)`

**UpdateEntity** `(*ClaudeCodePlugin) UpdateEntity(context.Context, string, map[string]interface{}) (domain.IExtensible, error)`

#### Types

**SessionEntity** `SessionEntity`

**NewSessionEntity** `NewSessionEntity(string, time.Time, int, []*domain.SessionAnalysis, int) *SessionEntity`

**GetID** `(*SessionEntity) GetID() string`

**GetType** `(*SessionEntity) GetType() string`

**GetCapabilities** `(*SessionEntity) GetCapabilities() []string`

**GetField** `(*SessionEntity) GetField(string) interface{}`

**GetAllFields** `(*SessionEntity) GetAllFields() map[string]interface{}`

**GetContext** `(*SessionEntity) GetContext() *domain.EntityContext`

**GetStatus** `(*SessionEntity) GetStatus() string`

**GetProgress** `(*SessionEntity) GetProgress() float64`

**IsBlocked** `(*SessionEntity) IsBlocked() bool`

**GetBlockReason** `(*SessionEntity) GetBlockReason() string`

**GetAnalyses** `(*SessionEntity) GetAnalyses() []*domain.SessionAnalysis`

**GetLatestAnalysis** `(*SessionEntity) GetLatestAnalysis() *domain.SessionAnalysis`

---

### tui

#### Types

**AnalysisViewerModel** `AnalysisViewerModel`

**NewAnalysisViewerModel** `NewAnalysisViewerModel(*domain.SessionAnalysis) AnalysisViewerModel`

**Init** `(AnalysisViewerModel) Init() tea.Cmd`

**Update** `(AnalysisViewerModel) Update(tea.Msg) (tea.Model, tea.Cmd)`

**View** `(AnalysisViewerModel) View() string`

**BackToDetailMsg** `BackToDetailMsg`

#### Types

**AppModel** `AppModel`

**NewAppModel** `NewAppModel(context.Context, *app.PluginRegistry, *app.AnalysisService, *app.LogsService, *domain.Config) *AppModel`

**Init** `(*AppModel) Init() tea.Cmd`

**Update** `(*AppModel) Update(tea.Msg) (tea.Model, tea.Cmd)`

**View** `(*AppModel) View() string`

**Run** `Run(context.Context, *app.PluginRegistry, *app.AnalysisService, *app.LogsService, *domain.Config) error`

#### Types

**LogViewerModel** `LogViewerModel`

**NewLogViewerModel** `NewLogViewerModel(string, []*app.LogRecord) LogViewerModel`

**Init** `(LogViewerModel) Init() tea.Cmd`

**Update** `(LogViewerModel) Update(tea.Msg) (tea.Model, tea.Cmd)`

**View** `(LogViewerModel) View() string`

#### Types

**SessionDetailModel** `SessionDetailModel`

**NewSessionDetailModel** `NewSessionDetailModel(*SessionInfo) SessionDetailModel`

**Init** `(SessionDetailModel) Init() tea.Cmd`

**Update** `(SessionDetailModel) Update(tea.Msg) (tea.Model, tea.Cmd)`

**View** `(SessionDetailModel) View() string`

**BackToListMsg** `BackToListMsg`

**AnalyzeSessionMsg** `AnalyzeSessionMsg`
- Properties:
  - SessionID string

**ReanalyzeSessionMsg** `ReanalyzeSessionMsg`
- Properties:
  - SessionID string

**SaveToMarkdownMsg** `SaveToMarkdownMsg`
- Properties:
  - SessionID string

**ViewAnalysisMsg** `ViewAnalysisMsg`
- Properties:
  - SessionID string

**ViewLogMsg** `ViewLogMsg`
- Properties:
  - SessionID string

#### Types

**TestFormatTokenCount** `TestFormatTokenCount(*testing.T)`

#### Types

**SessionItem** `SessionItem`

**FilterValue** `(SessionItem) FilterValue() string`

**Title** `(SessionItem) Title() string`

**Description** `(SessionItem) Description() string`

**SessionListModel** `SessionListModel`

**NewSessionListModel** `NewSessionListModel([]*SessionInfo) SessionListModel`

**Init** `(SessionListModel) Init() tea.Cmd`

**Update** `(SessionListModel) Update(tea.Msg) (tea.Model, tea.Cmd)`

**View** `(SessionListModel) View() string`

**GetSelectedSession** `(SessionListModel) GetSelectedSession() *SessionInfo`

**UpdateSessions** `(*SessionListModel) UpdateSessions([]*SessionInfo)`

**SelectedSessionMsg** `SelectedSessionMsg`
- Properties:
  - Session *SessionInfo

**RefreshRequestMsg** `RefreshRequestMsg`

#### Types

**ViewState** `ViewState`

**ViewSessionList** `ViewSessionList`

**ViewSessionDetail** `ViewSessionDetail`

**ViewAnalysisViewer** `ViewAnalysisViewer`

**ViewLogViewer** `ViewLogViewer`

**ViewAnalysisAction** `ViewAnalysisAction`

**ViewSaveDialog** `ViewSaveDialog`

**ViewProgress** `ViewProgress`

**SessionInfo** `SessionInfo`
- Properties:
  - SessionID string
  - ShortID string
  - FirstEvent time.Time
  - LastEvent time.Time
  - EventCount int
  - AnalysisCount int
  - Analyses []*domain.SessionAnalysis
  - HasAnalysis bool
  - LatestAnalysis *domain.SessionAnalysis
  - AnalysisTypes []string
  - TokenCount int

**SessionsLoadedMsg** `SessionsLoadedMsg`
- Properties:
  - Sessions []*SessionInfo
  - Error error

**AnalysisCompleteMsg** `AnalysisCompleteMsg`
- Properties:
  - SessionID string
  - Analysis *domain.SessionAnalysis
  - Error error

**SaveCompleteMsg** `SaveCompleteMsg`
- Properties:
  - FilePath string
  - Error error

**ErrorMsg** `ErrorMsg`
- Properties:
  - Error error

---

## Statistics

- **Total Files**: 41
- **Total Packages**: 7
- **Required Directories**: 4/4 present
- **Violations**: 5
- **External Dependencies**: 28

---

*This documentation is auto-generated. To regenerate: `go-arch-lint -format=full .` or `go-arch-lint -format=docs .`*
